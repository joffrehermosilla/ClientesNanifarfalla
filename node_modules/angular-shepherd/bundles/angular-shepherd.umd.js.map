{"version":3,"file":"angular-shepherd.umd.js","sources":["../../../projects/shepherd/src/lib/utils/dom.ts","../../../projects/shepherd/src/lib/utils/buttons.ts","../../../projects/shepherd/src/lib/shepherd.service.ts"],"sourcesContent":["/**\n * Helper method to check if element is hidden, since we cannot use :visible without jQuery\n * @param element The element to check for visibility\n * @returns true if element is hidden\n */\nexport function elementIsHidden(element: HTMLElement): boolean {\n  return element.offsetWidth === 0 && element.offsetHeight === 0;\n}\n","/**\n * Creates a button of the specified type, with the given classes and text\n *\n * @param button.type The type of button cancel, back, or next\n * @param button.classes Classes to apply to the button\n * @param button.text The text for the button\n * @param button.action The action to call\n */\nexport function makeButton(button) {\n  const { classes, disabled, label, secondary, type, text } = button;\n  const builtInButtonTypes = ['back', 'cancel', 'next'];\n\n  if (!type) {\n    return button;\n  }\n\n  if (builtInButtonTypes.indexOf(type) === -1) {\n    throw new Error(`'type' property must be one of 'back', 'cancel', or 'next'`);\n  }\n\n  return {\n    action: this[type].bind(this),\n    classes,\n    disabled,\n    label,\n    secondary,\n    text\n  };\n}\n","import { Injectable } from '@angular/core';\nimport Shepherd from 'shepherd.js';\nimport { elementIsHidden } from './utils/dom';\nimport { makeButton } from './utils/buttons';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ShepherdService {\n  confirmCancel = false;\n  confirmCancelMessage: string = null;\n  defaultStepOptions: object = {};\n  errorTitle = null;\n  isActive = false;\n  messageForUser: string = null;\n  modal = false;\n  requiredElements = [];\n  steps = [];\n  tourName = undefined;\n  tourObject: Shepherd.Tour = null;\n\n  constructor() {\n  }\n\n  /**\n   * Get the tour object and call back\n   */\n  back() {\n    this.tourObject.back();\n  }\n\n  /**\n   * Cancel the tour\n   */\n  cancel() {\n    this.tourObject.cancel();\n  }\n\n  /**\n   * Complete the tour\n   */\n  complete() {\n    this.tourObject.complete();\n  }\n\n  /**\n   * Hides the current step\n   */\n  hide() {\n    this.tourObject.hide();\n  }\n\n  /**\n   * Advance the tour to the next step\n   */\n  next() {\n    this.tourObject.next();\n  }\n\n  /**\n   * Show a specific step, by passing its id\n   * @param id The id of the step you want to show\n   */\n  show(id) {\n    this.tourObject.show(id);\n  }\n\n  /**\n   * Start the tour\n   */\n  start() {\n    this.isActive = true;\n    this.tourObject.start();\n  }\n\n  /**\n   * This function is called when a tour is completed or cancelled to initiate cleanup.\n   * @param completeOrCancel 'complete' or 'cancel'\n   */\n  onTourFinish(completeOrCancel: string) {\n    this.isActive = false;\n  }\n\n  /**\n   * Take a set of steps and create a tour object based on the current configuration\n   * @param steps An array of steps\n   */\n  addSteps(steps: Array<any>) {\n    this._initialize();\n    const tour = this.tourObject;\n\n    // Return nothing if there are no steps\n    if (!steps || !Array.isArray(steps) || steps.length === 0) {\n      return;\n    }\n\n    if (!this.requiredElementsPresent()) {\n      tour.addStep({\n        buttons: [{\n          text: 'Exit',\n          action: tour.cancel\n        }],\n        id: 'error',\n        title: this.errorTitle,\n        text: [this.messageForUser]\n      });\n      return;\n    }\n\n    steps.forEach((step) => {\n      if (step.buttons) {\n        step.buttons = step.buttons.map(makeButton.bind(this), this);\n      }\n\n      tour.addStep(step);\n    });\n  }\n\n  /**\n   * Observes the array of requiredElements, which are the elements that must be present at the start of the tour,\n   * and determines if they exist, and are visible, if either is false, it will stop the tour from executing.\n   */\n  private requiredElementsPresent() {\n    let allElementsPresent = true;\n\n    /* istanbul ignore next: also can't test this due to things attached to root blowing up tests */\n    this.requiredElements.forEach((element) => {\n      const selectedElement = document.querySelector(element.selector);\n\n      if (allElementsPresent && (!selectedElement || elementIsHidden(selectedElement))) {\n        allElementsPresent = false;\n        this.errorTitle = element.title;\n        this.messageForUser = element.message;\n      }\n    });\n\n    return allElementsPresent;\n  }\n\n  /**\n   * Initializes the tour, creates a new Shepherd.Tour. sets options, and binds events\n   */\n  private _initialize() {\n    const tourObject = new Shepherd.Tour({\n      confirmCancel: this.confirmCancel,\n      confirmCancelMessage: this.confirmCancelMessage,\n      defaultStepOptions: this.defaultStepOptions,\n      tourName: this.tourName,\n      useModalOverlay: this.modal\n    });\n\n    tourObject.on('complete', this.onTourFinish.bind(this, 'complete'));\n    tourObject.on('cancel', this.onTourFinish.bind(this, 'cancel'));\n\n    this.tourObject = tourObject;\n  }\n}\n"],"names":["Injectable"],"mappings":"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"}