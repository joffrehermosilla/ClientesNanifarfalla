{"version":3,"file":"angular-shepherd.js","sources":["../../../projects/shepherd/src/lib/utils/dom.ts","../../../projects/shepherd/src/lib/utils/buttons.ts","../../../projects/shepherd/src/lib/shepherd.service.ts"],"sourcesContent":["/**\n * Helper method to check if element is hidden, since we cannot use :visible without jQuery\n * @param element The element to check for visibility\n * @returns true if element is hidden\n */\nexport function elementIsHidden(element: HTMLElement): boolean {\n  return element.offsetWidth === 0 && element.offsetHeight === 0;\n}\n","/**\n * Creates a button of the specified type, with the given classes and text\n *\n * @param button.type The type of button cancel, back, or next\n * @param button.classes Classes to apply to the button\n * @param button.text The text for the button\n * @param button.action The action to call\n */\nexport function makeButton(button) {\n  const { classes, disabled, label, secondary, type, text } = button;\n  const builtInButtonTypes = ['back', 'cancel', 'next'];\n\n  if (!type) {\n    return button;\n  }\n\n  if (builtInButtonTypes.indexOf(type) === -1) {\n    throw new Error(`'type' property must be one of 'back', 'cancel', or 'next'`);\n  }\n\n  return {\n    action: this[type].bind(this),\n    classes,\n    disabled,\n    label,\n    secondary,\n    text\n  };\n}\n","import { Injectable } from '@angular/core';\nimport Shepherd from 'shepherd.js';\nimport { elementIsHidden } from './utils/dom';\nimport { makeButton } from './utils/buttons';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ShepherdService {\n  confirmCancel = false;\n  confirmCancelMessage: string = null;\n  defaultStepOptions: object = {};\n  errorTitle = null;\n  isActive = false;\n  messageForUser: string = null;\n  modal = false;\n  requiredElements = [];\n  steps = [];\n  tourName = undefined;\n  tourObject: Shepherd.Tour = null;\n\n  constructor() {\n  }\n\n  /**\n   * Get the tour object and call back\n   */\n  back() {\n    this.tourObject.back();\n  }\n\n  /**\n   * Cancel the tour\n   */\n  cancel() {\n    this.tourObject.cancel();\n  }\n\n  /**\n   * Complete the tour\n   */\n  complete() {\n    this.tourObject.complete();\n  }\n\n  /**\n   * Hides the current step\n   */\n  hide() {\n    this.tourObject.hide();\n  }\n\n  /**\n   * Advance the tour to the next step\n   */\n  next() {\n    this.tourObject.next();\n  }\n\n  /**\n   * Show a specific step, by passing its id\n   * @param id The id of the step you want to show\n   */\n  show(id) {\n    this.tourObject.show(id);\n  }\n\n  /**\n   * Start the tour\n   */\n  start() {\n    this.isActive = true;\n    this.tourObject.start();\n  }\n\n  /**\n   * This function is called when a tour is completed or cancelled to initiate cleanup.\n   * @param completeOrCancel 'complete' or 'cancel'\n   */\n  onTourFinish(completeOrCancel: string) {\n    this.isActive = false;\n  }\n\n  /**\n   * Take a set of steps and create a tour object based on the current configuration\n   * @param steps An array of steps\n   */\n  addSteps(steps: Array<any>) {\n    this._initialize();\n    const tour = this.tourObject;\n\n    // Return nothing if there are no steps\n    if (!steps || !Array.isArray(steps) || steps.length === 0) {\n      return;\n    }\n\n    if (!this.requiredElementsPresent()) {\n      tour.addStep({\n        buttons: [{\n          text: 'Exit',\n          action: tour.cancel\n        }],\n        id: 'error',\n        title: this.errorTitle,\n        text: [this.messageForUser]\n      });\n      return;\n    }\n\n    steps.forEach((step) => {\n      if (step.buttons) {\n        step.buttons = step.buttons.map(makeButton.bind(this), this);\n      }\n\n      tour.addStep(step);\n    });\n  }\n\n  /**\n   * Observes the array of requiredElements, which are the elements that must be present at the start of the tour,\n   * and determines if they exist, and are visible, if either is false, it will stop the tour from executing.\n   */\n  private requiredElementsPresent() {\n    let allElementsPresent = true;\n\n    /* istanbul ignore next: also can't test this due to things attached to root blowing up tests */\n    this.requiredElements.forEach((element) => {\n      const selectedElement = document.querySelector(element.selector);\n\n      if (allElementsPresent && (!selectedElement || elementIsHidden(selectedElement))) {\n        allElementsPresent = false;\n        this.errorTitle = element.title;\n        this.messageForUser = element.message;\n      }\n    });\n\n    return allElementsPresent;\n  }\n\n  /**\n   * Initializes the tour, creates a new Shepherd.Tour. sets options, and binds events\n   */\n  private _initialize() {\n    const tourObject = new Shepherd.Tour({\n      confirmCancel: this.confirmCancel,\n      confirmCancelMessage: this.confirmCancelMessage,\n      defaultStepOptions: this.defaultStepOptions,\n      tourName: this.tourName,\n      useModalOverlay: this.modal\n    });\n\n    tourObject.on('complete', this.onTourFinish.bind(this, 'complete'));\n    tourObject.on('cancel', this.onTourFinish.bind(this, 'cancel'));\n\n    this.tourObject = tourObject;\n  }\n}\n"],"names":[],"mappings":"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"}